---
title: "My title"
subtitle: "My subtitle if needed"
author: 
  - Laura Lee-Chu
  - Will Davidson
  - Syed Hassan
thanks: "Code and data are available at: LINK."
date: "`r Sys.time()`"
date-format: "D MMMM YYYY"
abstract: "First sentence. Second sentence. Third sentence. Fourth sentence."
format: pdf
number-sections: true
bibliography: references.bib
---

```{r}
#| include: false
#| echo: false
#| warning: false
#| message: false

library(tidyverse)
library(here)
library(readr)
library(readxl)
library(kableExtra)
library(scales)
library(knitr)

```



```{r}
#| echo: false
#| message: false

import_import_clean_data <- read_csv(
  here::here("outputs/data/clean_data.csv"),
  show_col_types = FALSE
)

check_unique_01 <- import_import_clean_data |>
  select(degree) |> 
  unique()

filter_degree <- import_import_clean_data |>
  filter(degree != ".d:  Do not Know/Cannot Choose") |> 
  filter(degree != ".n:  No answer")

# make sure the data is filtered from the arguments above
check_unique_02 <- filter_degree |>
  select(degree) |> 
  unique()
head(check_unique_02)
  
count_people_degree <- filter_degree |> 
  select(year, degree) |>
  group_by(year) |> 
  count(degree)

head(count_people_degree)

```

```{r}
#| label: education_total
#| fig-cap: Education level of the population.
#| fig-align: center
#| fig-width: 5.5
#| warning: false

count_people_degree |>
  mutate(across(degree, factor, levels=c("Graduate",
                                         "Bachelor's",
                                         "Associate/junior college",
                                         "High school",
                                         "Less than high school"))) |> 
  ggplot(aes(x = year, y = n)) +
  scale_x_continuous(breaks = seq(1998, 2018, 2)) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 65, vjust = 0.6)) +
  geom_point() +
  geom_line() +
  facet_wrap(
    ~degree,
    ncol = 2,
    scale="free_y") +
  labs(
    x = "year",
    y = "n"
  )
```


```{r}
#| echo: false
#| warning: false

degree_by_race <- filter_degree |> 
  select(year, degree, race) |>
  filter(degree != "Less than high school") |>
  filter(degree != "High school") |>
  group_by(degree, race) |>
  count(year)

# degree_by_race_table <- import_clean_data |>
#   select(year, degree, race) |>
#   group_by(year, degree, race) |>
#   count(year)

```


```{r}
#| label: degree_by_race
#| fig-cap: Number of people with post-secondary education.
#| fig-align: center
#| fig-width: 5.5
#| warning: false

degree_by_race |>
  ggplot(aes(x = year, y = n, color = race)) +
  geom_point() +
  geom_line() +
  theme_minimal() +
  facet_wrap(
    ~degree,
    ncol = 1
  ) +
  scale_x_continuous(breaks = seq(1998, 2018, 2)) +
  scale_y_continuous(breaks = seq(0, 650, 100)) +
  labs(
    x = "Year",
    y = "number of degree holders",
    color = "race"
  ) +
  scale_color_brewer(palette = "Set1")



```

```{r}
#| echo: false
#| warning: false

?arrange
# firsttabl <- tabyl(year, degree, race) |> #filtering only needed data
#   adorn_totals(c("row", "col")) |> #calculating totals of all selected values
#   select("") |> #selecting only years with completed data 
#   kable(booktabs = T, caption = "Number of Apprehensions by MHA Apprehension Type from 2014 to 2021",
#     col.names = c("MHA Apprehension Types", "2014", "2015", "2016", "2017", "2018", "2019", "2020", "2021"), 
#     align = "l"
#   )
```


\newpage


# References


